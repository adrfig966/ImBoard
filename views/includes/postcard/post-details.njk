<div class="content-half col-12 col-md-6 d-flex flex-column justify-content-between">
  <div class="post-content">
    <div class="row my-2">
      <div class="col-12">
        <p class="mb-0"><strong class="id2dt">{{post._id}}</strong></p>
        <small>
          posted by
          {{post.user}}
        </small>
        <p class="mt-0">
            {% if isloop %}
            {{post.content | truncate(100)}}
            {% else %}
            {{post.content}}
            {% endif %}
        </p>
      </div>
    </div>
  </div>
  <div class="post-feedback">
    <hr>
    <div class="row mb-2">
      <div class="col-12 col-md-6 mb-2 mb-md-0 d-flex align-items-center">
        <span class="badge badge-pill badge-light">Comments: {{post.commentcount}}</span>
        <span class="badge badge-pill badge-light">Likes: {{ post.likescount }}</span>
        <span class="badge badge-pill badge-light">Dislikes: {{ post.dislikescount }}</span>
      </div>
    </div>
    <div class="btn-group mb-2" role="group" aria-label="Vote buttons">
      {# Disable liking if user is not logged in. 'canlike' is a variable based on whether a user is logged in and has liked/disliked a post. This variable is generated by an aggregation pipeline. #}
      {% set removelike = not post.canlike %}
      {% set removedislike = not post.candislike %}
      <button class="btn btn-light comment-btn" onclick="addcomment(event,'{{post._id}}', '{{section}}', '{{user.mongo_id}}')" type="button"><i class="fas fa-reply"></i></button>
      <button type="button" class="btn {{ 'btn-primary' if post.canlike else 'btn-secondary' }}" {% if not user %} disabled {% endif %} onclick="sendvote(event,'likes','{{post._id}}', {{ removelike }})"><i class="fas fa-thumbs-up"></i></button>
      <button type="button" class="btn {{ 'btn-primary' if post.candislike else 'btn-secondary' }}" {% if not user %} disabled {% endif %} onclick="sendvote(event,'dislikes','{{post._id}}', {{ removedislike }})"><i class="fas fa-thumbs-down"></i></button>
      <button class="btn btn-light" onclick="gotopost(event,'{{post._id}}', '{{section}}')" type="button"><i class="fas fa-eye"></i> View</button>
    </div>
    {# Display a message if user is not logged in informing them to log in to post. This can be determined by checking the user variable that is attached to every response if a user is authenticated. #}
    {% if not user %}
    <div class="row mb-2">
      <div class="col-12"><small>Please <strong>sign in</strong> to vote on this post.</small></div>
    </div>
    {% endif %}
  </div>
</div>
